<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>ポイントカード</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
     <script src="liff.js"></script>
      <script src="liff.js"></script>
     <script src="index.js"></script>
    
    <link rel="stylesheet" type="text/css" href="./public/card.css">
</head>
<body>
 
    <div class="card1">
    
        <p class="title1">Coco point </p>
        <div id="name" class="content1"><div id="data-container"></div></div>
        <div id="point" class="content2"><div id="data-container2"></div>

<div id="fixed">
© Coco medaka3
</div>
<script>
    // LIFFの初期化
    liff.init({ liffId: '2001059289-X2m74PYZ' }, () => {
        if (liff.isLoggedIn()) {
            // ユーザーがログインしている場合
            sendIdTokenToGAS();
        } else {
            // ログインが必要な場合、ログインページを表示
            liff.login();
        }
    });

    // IDトークンをGASに送信する関数
    function sendIdTokenToGAS() {
        const idToken = liff.getIDToken();
        
        // IDトークンをGASに送信
        $.ajax({
            url: 'https://script.google.com/macros/s/AKfycbz_FICjBMQCZU3IhibmeuHuvDZIQHaDe1eYUoUePk9ZGp9UnKHcPlukFfJd8GBVhfbdEw/exec', // Google Apps Scriptのエンドポイントを指定
            type: 'POST',
            data: { idToken: idToken },
            success: function(response) {
                // 成功時の処理
                console.log(response);
                displayMessage(response); // レスポンスメッセージを表示     
                displayData(response)
                
            },
            error: function(error) {
                // エラー時の処理
                console.error(error);
                alert('Failed to send ID Token to GAS.');
            }
        });
    }

    // メッセージを表示する関数
    function displayMessage(message) {
        const messageElement = document.createElement('p');
        messageElement.textContent = message;
        document.body.appendChild(messageElement);


    }








        // APIからデータを取得する関数
    //    async function fetchData() {
     //       try {
      //          const response = await fetch(apiEndpoint);
       //         const data = await response.json();
        //        displayData(data);
      //      } catch (error) {
       //         console.error("Error fetching data:", error);
      //      }
     //   }

        // 取得したデータをHTMLに表示する関数
        function displayData(data) {
            const container = document.getElementById("data-container");
            // データを表示するための処理をここに追加
            // 例: データを段落要素に挿入
            const paragraph = document.createElement("p");

            paragraph.textContent = `現在のポイント： ${data[0].medaka5}pt`;
            container.appendChild(paragraph);

            const container2 = document.getElementById("data-container2");
            // データを表示するための処理をここに追加
            // 例: データを段落要素に挿入
            const paragraph2 = document.createElement("p");

            paragraph2.textContent = `現在のポイント： ${data[0].medaka6}pt`;
            container2.appendChild(paragraph2);
        }





    






    





    
</script>


 


</body>
</html>




